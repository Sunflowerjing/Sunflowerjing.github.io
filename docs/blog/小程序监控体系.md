# 小程序监控体系


1. 监控的`优点`?
    * 针对线上问题: 及时`发现、定位、解决，减少影响用户数`。
    * 有一个系统能`收集用户的使用信息`。辅助问题的定位与修复，减少开发人员的负担，那么小程序监控就非常有必要了。


2. 小程序监控方案分类:
    * `用户数据监控`：新增用户数、访问次数、用户留存率等数据。
    * `错误监控`：
        * 网络请求: 
            1. API 成功率(通过 hack 的方式获取到请求发起的状态及请求返回后的状态，从而计算到 API 的成功率及耗时情况)
            2. 定位问题：全链路追踪
        * 页面报错
    * `性能监控`：微信官方提供。
        * app启动时间
        * 各类函数(wx系统，app.js，page)的执行时间及页面渲染时间
        * 性能数据（cpu, fps, mem）

3. 公司现有监控体系梳理
    <style>
    table th:first-of-type {
        width: 15%;
    }
    table th:nth-of-type(2) {
        width: 25%;
    }
    table th:nth-of-type(3) {
        width: 30%;
    }
    table th:nth-of-type(4) {
        width: 40%;
    }
    </style>
    |  平台         |  用户数据监控          |    错误监控     |     性能监控     |
    |  ----         |      ----      |   ----  | ----  |
    |  旧小程序      |     Qmark       |   apm   |    错误查询、实时日志、性能监控、告警设置、小程序测速<br>微信官方收集    |
    |  RN           |      无      |   崩溃、卡顿、错误 <br> apm | 埋点: 达芬奇
    |  大客户端         |  点击、页面跳转、崩溃  <br> apm      |   页面、服务不可用 <br> apm  | 启动时长、加载时长、请求时长 <br> 达芬奇、qlibra  |
    |  新小程序       |     埋点<br>统计 pv、uv        |   页面: js 异常 （崩溃）<br>服务不可用: 400、500实现方案埋点(错误)<br>卡顿: 机制(调用系统方法，<500 为卡顿 )  | 接口耗时（埋点）<br>启动（埋点）: 点击 - 加载 - 可见  |
   

4. 实现人员
    * 公共产研`前端框架组`: SDK
    * 公共产研`APM组`: 统计数据
    * 公共产研发`数据组`: 统计数据


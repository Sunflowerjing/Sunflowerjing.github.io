# 微信小程序自动发布

## nodeJS
1. nodejs是一个基于 `Chrome V8 引擎`的 `JavaScript 运行环境`，异步IO，具有高的并发性能。无需借用一些web服务器软件（如apache、nginx, IIS）即可实现web服务的搭建。
2. nodeJS基础模块学习,当一个Nodejs程序运行时，会有许多存在内存中的全局变量。
* `path模块`提供用于处理文件路径和目录路径的实用工具
```
const path = require('path');
```
* `fs 模块`提供了文件系统进行交互, 所有文件系统操作都具有同步和异步的形式
```
const fs = require('fs');
```
* `process.argv ` 属性返回一个数组，其中包含当启动 Node.js 进程时传入的命令行参数。
    * 第一个元素是 `process.execPath`,node的执行路径。如果需要访问 `argv[0]` 的原始值，参阅 `process.argv0`。 
    * 第二个元素将是正在执行的 `JavaScript 文件的路径`。 即当前执行文件的路径
    * 从第三个元素开始，是执行时带入的参数。
    * 例如，假设 process-args.js 的脚本如下：
    ```
    // 打印 process.argv。
    process.argv.forEach((val, index) => {
        console.log(`${index}: ${val}`);
    });
    ```
    * 启动 Node.js 进程：`$ node process-args.js one two=three four`
    * 输出如下：
    ```
    0: /usr/local/bin/node
    1: /Users/mjr/work/node/process-args.js
    2: one
    3: two=three
    4: four
    ```




## pm2
1. pm2是基于nodejs开发的`进程管理器`，适用于后台常驻脚本管理，同时对node网络应用有自建负载均衡功能。



## commander.js
1. `commander.js一个工具包`，其作用是让node命令行程序的制作更加简单。
    * commander.js中命令行有两种可变性，一个叫做`option`，意为选项。一个叫做`command`，意为命令。
    * 通过`option`设置的选项可以通过`program.chdir`或者`program.noTests`来访问。
    * 通过`command`设置的命令通常`在action回调`中处理逻辑。
2. 使用方式，正常的引入
``` 
const program = require('commander');
```
###  commander的 API
1. `version`: 用于设置命令程序的`版本号`
    * 用法： `.version('x.y.z')`

2. `option`: 用于定义命令`选项`
    * 用法： `.option('-n, --name <name>', 'your name', 'GK')`
    * 第一个参数是选项定义，分为短定义和长定义。用|，,，连接。
        * 参数可以用<>或者[]修饰，前者意为必须参数，后者意为可选参数。
    * 第二个参数为选项描述
    * 第三个参数为选项参数默认值，可选
    * 示例: program.name值为123 不输入123则取默认值GK

3. `command`: 添加`命令`名称
    * 用法：`.command('init <path>', 'description')`
    * command的用法稍微复杂，原则上他可以接受三个参数，第一个为命令定义，第二个命令描述，第三个为命令辅助修饰对象。
    * 第一个参数中可以使用<>或者[]修饰命令参数,在命令后面传入的参数会被传入到 action 的回调函数以及 program.args 数组中。
    * 第二个参数可选。
        * 当没有第二个参数时，commander.js将返回Command对象，若有第二个参数，将返回原型对象。
        * 当带有第二个参数，并且没有显示调用action(fn)时，则将会使用子命令模式。
        * 所谓子命令模式即，./pm，./pm-install，./pm-search等。这些子命令跟主命令在不同的文件中。
    * 第三个参数一般不用，它可以设置是否显示的使用子命令模式
4. `description`: 用于设置命令的`描述`
    * 用法：`.description('command description')`
5. `action`: 用于设置命令`执行的相关回调`。
    * 用法：`.action(fn)`
    * `fn`可以接受命令的参数为函数形参，顺序与command()中定义的顺序一致。
6. `parse`: 此api一般是最后调用，用于解析`process.argv`。
    * 用法：`program.parse(process.argv)`
7. `outputHelp`: 一般用于未录入参数时自动打印帮助信息。 
    * 用法：program.outputHelp()


## 简单的单位
1. K是KB的简称, 1kb(bit)
2. 1024KB=1MB 
3. 1024MB=1GB
4. 如果这个单位用在网络带宽上，则1K＝1/1024M
5. 如果是用在磁盘容量上，则1K=1/1000M


## egg
1. `ctx.getFileStream()`  获取文件流
    `ctx.getFileStream().filename`  通过流获取文件名字
2. `ctx.app.config.WX_PKG_CACHE_PATH` 访问配置对象
3. `process.env` 返回用户运行环境对象
4. `import fse from 'fs-extra';`
    * `fse.emptyDirSync('mydir')` 确保目标目录是空的，如果目录不是空的，删除目录里所有内容；如果目录不存在，创建目录。目录本身不删除。
    例如：`fs.emptyDirSync('/tmp/some/dir')`  //确保最终存在一个空的目录
    * `fse.createWriteStream()` 此方法有两个参数，第一个参数是读取文件的路径, 第二个参数为 options 选项，其中有七个参数。
5. `path.join()` 方法使用平台特定的分隔符把全部给定的 path 片段连接到一起，并规范化生成的路径。
例如: `path.join('foo', 'baz', 'bar');` // 返回 'foo/baz/bar'
6. 
